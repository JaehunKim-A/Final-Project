<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raw-Material-Inbound</title>

    <!-- 스타일 시트 -->
    <link rel="stylesheet" href="/assets/extensions/simple-datatables/style.css">
    <link rel="stylesheet" href="/assets/compiled/css/table-datatable.css">
    <link rel="stylesheet" href="/assets/compiled/css/app.css">
    <link rel="stylesheet" href="/assets/compiled/css/app-dark.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
<div id="app">
    <!-- 사이드바 -->
    <div id="sidebar" th:replace="~{layout/layout :: sidebar}"></div>

    <div id="main" class="layout-navbar navbar-fixed">
        <!-- 헤더 -->
        <header class="mb-3" th:replace="~{layout/layout :: header}"></header>

        <h1>원자재 입고 목록</h1>

        <table class="table">
            <thead>
            <tr>
                <th>입고 ID</th>
                <th>원자재 ID</th>
                <th>원자재 코드</th>
                <th>수량</th>
                <th>입고 날짜</th>
                <th>입고 코드</th>
                <th>공급업체 ID</th>
                <th>상태</th>
                <th>관리</th>
            </tr>
            </thead>
            <tbody>
            <!-- 타임리프 데이터 반복 -->
            <tr th:each="inbound : ${rawMaterialInbounds}">
                <td th:text="${inbound.inboundId}"></td>
                <td th:text="${inbound.materialId}"></td>
                <td th:text="${inbound.materialCode}"></td>
                <td th:text="${inbound.quantity}"></td>
                <td th:text="${inbound.inboundDate}"></td>
                <td th:text="${inbound.inboundCode}"></td>
                <td th:text="${inbound.supplierId}"></td>
                <td th:text="${inbound.status}"></td>
                <td>
                    <!-- 수정 버튼 -->
                    <button class="btn btn-success edit-btn"
                            data-id="[[${inbound.inboundId}]]"
                            data-material-id="[[${inbound.materialId}]]"
                            data-material-code="[[${inbound.materialCode}]]"
                            data-quantity="[[${inbound.quantity}]]"
                            data-inbound-date="[[${inbound.inboundDate}]]"
                            data-inbound-code="[[${inbound.inboundCode}]]"
                            data-supplier-id="[[${inbound.supplierId}]]"
                            data-status="[[${inbound.status}]]">
                        수정
                    </button>

                    <!-- 삭제 버튼 -->
                    <button class="btn btn-danger delete-btn" data-id="[[${inbound.inboundId}]]">삭제</button>
                </td>
            </tr>
            </tbody>
        </table>

        <!-- 원자재 수정 모달 -->
        <div class="modal fade" id="editRawMaterialInboundModal" tabindex="-1" aria-labelledby="editRawMaterialInboundModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">원자재 입고 수정</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editRawMaterialInboundForm">
                            <input type="hidden" id="editInboundId" name="inboundId">

                            <div class="mb-3">
                                <label class="form-label">원자재 ID</label>
                                <input type="text" class="form-control" id="editMaterialId" name="materialId" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">원자재 코드</label>
                                <input type="text" class="form-control" id="editMaterialCode" name="materialCode" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">수량</label>
                                <input type="number" class="form-control" id="editQuantity" name="quantity" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">입고 날짜</label>
                                <input type="date" class="form-control" id="editInboundDate" name="inboundDate" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">입고 코드</label>
                                <input type="text" class="form-control" id="editInboundCode" name="inboundCode" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">공급업체 ID</label>
                                <input type="text" class="form-control" id="editSupplierId" name="supplierId" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">상태</label>
                                <select id="editStatus" name="status" class="form-control">
                                    <option value="Completed">Completed</option>
                                    <option value="Pending">Pending</option>
                                    <option value="Canceled">Canceled</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">수정 완료</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // 모든 수정 버튼 가져오기
        const editButtons = document.querySelectorAll(".edit-btn");

        editButtons.forEach(button => {
            button.addEventListener("click", function () {
                // 버튼에 저장된 data 속성 값 가져오기
                const id = this.getAttribute("data-id");
                const materialId = this.getAttribute("data-material-id");
                const materialCode = this.getAttribute("data-material-code");
                const quantity = this.getAttribute("data-quantity");
                const inboundDate = this.getAttribute("data-inbound-date");
                const inboundCode = this.getAttribute("data-inbound-code");
                const supplierId = this.getAttribute("data-supplier-id");
                const status = this.getAttribute("data-status");

                // 모달 입력 필드에 데이터 설정
                document.getElementById("editInboundId").value = id;
                document.getElementById("editMaterialId").value = materialId;
                document.getElementById("editMaterialCode").value = materialCode;
                document.getElementById("editQuantity").value = quantity;
                document.getElementById("editInboundDate").value = inboundDate;
                document.getElementById("editInboundCode").value = inboundCode;
                document.getElementById("editSupplierId").value = supplierId;
                document.getElementById("editStatus").value = status;

                // 부트스트랩 모달 열기
                const editModal = new bootstrap.Modal(document.getElementById("editRawMaterialInboundModal"));
                editModal.show();
            });
        });
    });
</script>

</body>
</html>
